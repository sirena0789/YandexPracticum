## Описание проекта

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. 
Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. 
Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

### Описание услуг

Оператор предоставляет два основных типа услуг:   

1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.  
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL*,* от англ. *digital subscriber line*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).  

Также доступны такие услуги:  

- Интернет-безопасность: антивирус (*DeviceProtection*) и блокировка небезопасных сайтов (*OnlineSecurity*);  
- Выделенная линия технической поддержки (*TechSupport*);  
- Облачное хранилище файлов для резервного копирования данных (*OnlineBackup*);
- Стриминговое телевидение (*StreamingTV*) и каталог фильмов (*StreamingMovies*).  

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года.  
Доступны различные способы расчёта и возможность получения электронного чека.

## План работы

1. Знакомство с данными. Необходимо выгрузить и проверить типы данных и наличие пропусков. 
2. Предобработка данных. На этом этапе нужно подготовить данные. В данном случае требуется обьединить датафреймы по ключу customerID, избавиться от пропусков в последствии, изменить типы данных и привести названия столбцов к нижнему регистру.
3. Исследовательский анализ данных. Необходимо визуализировать данные, исследовать корреляцию между признаками и избавиться от выбросов. 
4. Подготовить данные для обучения модели. Удалить,если есть, ненужные столбцы, разделить данные на выборки, закодировать категориальные признаки с помощью OneHotEncoder, для линейных моделей масштабировать числовые признаки. 
5. Подбор гиперпараметров и обучение 2-3 моделей. 
6. Тестирование наилучшей модели. 
7. Вывод.  

**Цель работы**  
Прогноз оттока клиентов для предложения им ряда дополнительных услуг или бонусов для оптимизации и регулировки количества пользователей данного оператора связи, следствием чего является увеличение/сохранение выручки компании.

## Отчет

В проекте были выполнены следующие пункты: 
- Знакомство с данными. Выгружены и проверены типы данных и наличие пропусков.
- Предобработка данных. Добавлен целевой признак ухода/неухода клиента. Заменили в EndDate значения "No" датой выгрузки датасета. Заменили тип данных в BeginDate, EndDate и TotalCharges и избавились от попусков. Обьеденили датасеты и устранили пропуски. 
- Исследовательский анализ данных. Визуализировали категориальные и количественные признаки. Выявили корреляцию в MonthlyCharges и TotalCharges, StreamingTV и StreamingMovies, Partner и Dependents. Убрали столбцы с датами и сгененрировали новый признак с количеством дней использования услуг. Избавились от столбца gender, так как он не влияет на уход клиента, но может помешать обученнию модели. На основе предварительного анализа предположили, что со временем вероятность отказа от услуг снижается, также чаще от услуг отказываются те, кто больше за них платит.
- Подготовили данные для обучения модели. Разделили данные на выборки с параметрами test_size=0.25, random_state=50623; закодировать категориальные признаки с помощью OneHotEncoder, для линейных моделей масштабировали числовые признаки.
- Обучение моделей. Для обучения были выбраны следующие признаки: 
1. *Категориальные*  
    'Type' - тип оплаты,
    'PaperlessBilling' - безналичный расчет,
    'PaymentMethod' – способ оплаты,,
    'Partner' - наличие супруга(и),
    'Dependents' - наличие иждивенцев,
    'SeniorCitizen' - наличие пенсионного статуса по возрасту,
    'InternetService' - интернет сервис,
    'OnlineSecurity' - онлайн защита,
    'OnlineBackup' - резервное копирование,
    'DeviceProtection' - защита устройства,
    'TechSupport' - тех поддержка,
    'StreamingTV' - ТВ,
    'StreamingMovies' - фильмы,
    'MultipleLines' - наличие возможности ведения параллельных линий во время
    звонка. 
2. *Количественные*  
    'MonthlyCharges' – ежемесячные траты на услуги,
    'TotalCharges' - общие траты,
    'Days' - общее количество дней пользования услугами оператора (сгенерированный признак).
3. *Целевой*  
    'tag' - факт ухода клиента (сгенерированный признак).  


Был произведен подбор гиперпараметров и обучение следующих моделей:

| Model | ROC_AUC |
| ------ | ------ |
| LogisticRegression | 0.768698 |
| RandomForestClassifier | 0.818619 |
| LinearSVC | 0.771330 |
| LGBMClassifier | 0.898903 |
| XGBClassifier | 0.913498 |
| CatBoostClassifier | 0.920756 |

- Тестирование наилучшей модели. Для теста была выбрана модель:  
    CatBoostClassifier, ROC-AUC = 0.920756,  iterations=1000,  learning_rate=0.5,  max_depth=2.    
 
 
- Показатели на тестовой выборке:   
1. Accuracy:  0.9114139693356048
2. AUC-ROC:  0.9083790293650387   
  
  
- Самыми важными признаками являются:  
1. Время пользования услугами оператора (61.7%), 
2. Сумма потрачененных средств на услуги (16.7%), 
3. Ежемесячные траты на услуги (9.6%)
  
  
- Рекомендации для оператор связи «Ниединогоразрыва.ком»: 
1. Стоит обращать особое внимание на новых пользователей. Возможно стоит предлагать новичкам более выгодные тарифы и услуги. 
2. Также стоит уделить внимание группам пользователей с высокими показателями оплат услуг в месяц. Хорошим вариантом будет предоставлять скидку на оплату за несколько месяцев и год. Хорошим спосбом удержать клиентов - ввести бонусную программу по типу "чем больше платишь - тем больше скидка/бонусы".
  
  
- Отличия от исходного плана работ:
1. приводить названия столбцов к нижнему регистру не понадобилось;
2. выбросы не были обнаружены;
3. были добавлены столцы с целевым признаком и временем пользования услугами;
4. обучалось 6 моделей, вместо заявленных 2-3, так как на начальном этапе не удавалось добиться нужных показателей метрики и пришлось импровизировать с различными моделями;
5. после тестирования была добавлена визуализация важности признаков.  

Трудностей в работе не встречалось, все этапы выполнения проекта являются важными и нельзя опускать ни один из них. 
